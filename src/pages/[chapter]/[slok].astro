---
import { getCollection } from "astro:content";
import BaseHead from "../../base/BaseHead.astro";
import MobileLayout from "../../base/layouts/MobileLayout.astro";
import { getEntry } from "astro:content";
export async function getStaticPaths() {
  const sloks = await getCollection("sloks");

  return sloks.map((item) => ({
    params: {
      chapter: item.data.chapter_number.toString(),
      slok: item.data.verse_number.toString(),
    },
    props: { slok: item },
  }));
}

const { slok } = Astro.props;

// const commentaries = (await getCollection("chapters")).filter((c)=>c.data.);
const commentaries = await getEntry(
  "translations",
  `${slok.data.chapter_number}/${slok.data.verse_number}`,
);

console.log(commentaries?.data.filter((c) => c.author_id == 7));
---

<BaseHead
  description={`Read Bhagavad Gita ${slok.data.chapter_number}.${slok.data.verse_number} in Sanskrit with English meaning. Understand the verse's message and its spiritual significance as explained by Lord Krishna.`}
  title={`Bhagavad Gita ${slok.data.chapter_number}.${slok.data.verse_number} - Slokas with meaning`}
>
  <MobileLayout>
    <h2
      transition:name={`slok-name-${slok.id}`}
      class="text-3xl font-bold text-center p-2"
    >
      BG
      {slok.data.chapter_number}.{slok.data.verse_number}
    </h2>

    <p
      class="text-center font-normal text-amber-500 text-2xl"
      id="output"
      set:html={slok.data.text.split("\n\n").join("<br/>")}
    />

    {JSON.stringify(commentaries)}
  </MobileLayout>
</BaseHead>

<script></script>
